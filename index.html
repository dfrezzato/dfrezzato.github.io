<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      FWD&gt;&gt;FunWithData &middot; 
    
  </title>

  
  <link rel="stylesheet" href="/css/poole.css">
  <link rel="stylesheet" href="/css/syntax.css">
  <link rel="stylesheet" href="/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/assets/favicon.ico">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.14/d3.min.js"></script>
  
  <link href="/css/nv.d3.min.css" rel="stylesheet">
  <script src="/js/nv.d3.min.js"></script>
  <script src="/js/multi-series-line.js"></script>


</head>


  <body>

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Fun With Data : actuariat, visualisation, données et web</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item  active " href="/">Home</a>
    <a class="sidebar-nav-item " href="/post">Posts</a>

    
    
      
    
      
    
      
    
      
    
      
    
      
    

    
  </nav>

  <div class="sidebar-item">
    <p>&copy; 2016. Tous droits réservés.</p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">FWD&gt;&gt;FunWithData</a>
            <small></small>
          </h3>
        </div>
      </div>

      <div class="container content">





<div class="posts">
  
    <div class="post">
        <h1 class="post-title"><a href="http://alea.io/post/premier_nvd3/">Graphique simple nvd3</a></h1>
        <span class="post-date">Mar 7 2016</span>
        

<p>Lorsqu&rsquo;on souhaite illustrer graphiquement le contenu d&rsquo;un fichier de données, faire de la <em>data visualisation</em>, on pourra s&rsquo;appuyer sur des bibliothèques javascript. La principale est d3.js. Pour une mise en oeuvre plus aisée (mais plus limitée), on peut déjà bien s&rsquo;amuser avec nvd3.</p>

<h2 id="nvd3:2f6284593b2a6d0b98606de1c5b5b907">nvd3</h2>

<p><a href="http://nvd3.org/">nvd3</a> est une bibliothèque javascript de visualisation basée sur <a href="https://d3js.org/">d3.js</a>.</p>

<p>Pour pouvoir utiliser <a href="http://nvd3.org/">nvd3</a>, il faut récupérer le css et le javascript sur le <a href="https://github.com/novus/nvd3">dépôt github nvd3</a> puis les mettre respectivement dans :</p>

<ul>
<li><p><code>&lt;dossier du site&gt;/themes/lanyon-hugo/static/css/nv.d3.min.css</code> et</p></li>

<li><p><code>&lt;dossier du site&gt;/themes/lanyon-hugo/static/js/nv.d3.min.js</code>.</p></li>
</ul>

<p>Ensuite, dans <code>&lt;dossier du site&gt;/themes/lanyon-hugo/partials/head.html</code>, insérer :</p>

<pre><code class="language-html">&lt;link href=&quot;/css/nv.d3.min.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;script src=&quot;/js/nv.d3.min.js&quot;&gt;&lt;/script&gt;
</code></pre>

<p>Pour construire mon exemple, j&rsquo;ai aussi inséré la référence du javascript que j&rsquo;ai créé pour l&rsquo;occasion :</p>

<pre><code class="language-html">&lt;script src=&quot;/js/multi-series-line.js&quot;&gt;&lt;/script&gt;
</code></pre>

<p><strong>Attention :</strong> Les exemples du site <a href="http://nvd3.org/">nvd3</a> ne fonctionnent pas avec la version du projet qui est sur github, il faut donc récupérer les exemples sur github et les adapter pour son propre usage.</p>

<p>En général, l&rsquo;exemple disponible n&rsquo;est pas utilisable directement : il faut adapter les données en entrée pour les mettre dans le format attendu par le script.</p>

<p>On peut tester que cela fonctionne en faisant un premier graphique.</p>

<h1 id="premier-graphique:2f6284593b2a6d0b98606de1c5b5b907">premier graphique</h1>

<p>Voici les <a href="/assets/data-multiserieslines.csv">Données source</a>, ainsi que le <a href="/js/multi-series-line.js">Script</a> exemple adapté aux données sources.</p>

<div id="multi-series-line">
<svg width="100%" height="400px"></svg>
</div>

<script>
    msl('#multi-series-line svg', '/assets/data-multiserieslines.csv', 'Montant', 100);
</script>

<h1 id="explications:2f6284593b2a6d0b98606de1c5b5b907">explications</h1>

<p>Pour mettre le graphique dans la page, j&rsquo;ai inséré les lignes suivantes dans mon post :</p>

<pre><code class="language-html">&lt;div id=&quot;multi-series-line&quot;&gt;
&lt;svg width=&quot;100%&quot; height=&quot;400px&quot;&gt;&lt;/svg&gt;
&lt;/div&gt;

&lt;script&gt;
	msl('#multi-series-line svg', '/assets/data-multiserieslines.csv', 'Montant', 100);
&lt;/script&gt;
</code></pre>

<p>L&rsquo;exemple disponible sur le site <a href="http://nvd3.org/">nvd3</a> a été adapté. Il comportait le code suivant :</p>

<pre><code class="language-javascript"> /*These lines are all chart setup.  Pick and choose which chart features you want to utilize. */
 nv.addGraph(function() {
   var chart = nv.models.lineChart()
                 .margin({left: 100})  //Adjust chart margins to give the x-axis some breathing room.
                 .useInteractiveGuideline(true)  //We want nice looking tooltips and a guideline!
                 .transitionDuration(350)  //how fast do you want the lines to transition?
                 .showLegend(true)       //Show the legend, allowing users to turn on/off line series.
                 .showYAxis(true)        //Show the y-axis
                 .showXAxis(true)        //Show the x-axis
   ;

   chart.xAxis     //Chart x-axis settings
       .axisLabel('Time (ms)')
       .tickFormat(d3.format(',r'));

   chart.yAxis     //Chart y-axis settings
       .axisLabel('Voltage (v)')
       .tickFormat(d3.format('.02f'));

   /* Done setting the chart up? Time to render it!*/
   var myData = sinAndCos();   //You need data...

   d3.select('#chart svg')    //Select the &lt;svg&gt; element you want to render the chart in.   
       .datum(myData)         //Populate the &lt;svg&gt; element with chart data...
       .call(chart);          //Finally, render the chart!

   //Update the chart when window resizes.
   nv.utils.windowResize(function() { chart.update() });
   return chart;
 });
</code></pre>

<p>Ce code a dû ête adapté de deux façons :</p>

<ol>
<li>la première a été d&rsquo;<em>enfermer</em> le code dans une fonction afin qu&rsquo;il soit réutilisable aisément ;</li>
<li>la seconde a été de créer une fonction de lecture de données basée sur d3.csv afin de pouvoir lire un fichier csv en entrée du graphe.</li>
</ol>

<p>Ces techniques seront détaillées dans un post ultérieur.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://alea.io/post/hugo_favicon/">favicon, sidebar</a></h1>
        <span class="post-date">Feb 20 2016</span>
        

<h2 id="créer-une-favicon:2e53a4e69a27fda7e54c1327844b6488">Créer une favicon</h2>

<p>Si on n&rsquo;est pas <em>designer</em> ou graphiste, il vaut mieux utiliser un site de génération automatique : <a href="http://antifavicon.com/">site générateur de favicon</a></p>

<h2 id="modifier-le-texte-à-côté-de-la-favicon:2e53a4e69a27fda7e54c1327844b6488">Modifier le texte à côté de la favicon</h2>

<p>Il suffit d&rsquo;indiquer le paramètre du site qui contient le titre i.e. <code>Title</code>.</p>

<p>dans <code>&lt;dossier du site&gt;/config.toml</code>, insérer dans la section <code>Params</code>:</p>

<pre><code>[Params]
	Title=&quot;le nouveau titre&quot;
</code></pre>

<h2 id="mettre-le-lien-vers-un-post-dans-la-sidebar:2e53a4e69a27fda7e54c1327844b6488">Mettre le lien vers un post dans la sidebar</h2>

<p>Ajouter dans l&rsquo;entête de l&rsquo;article <code>sidebar = true</code> et <code>weight = 10</code> qui indique la position relative des liens de la sidebar (le plus lourd tombe au fond)</p>

<pre><code>+++
date = &quot;2016-02-20&quot;
draft = false
title = &quot;favicon, sidebar&quot;
sidebar = true
weight = 10
+++
</code></pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://alea.io/post/hugo_google_analytics/">google analytics</a></h1>
        <span class="post-date">Feb 20 2016</span>
        

<h2 id="script-à-intégrer:288ba409f9a55331bb5f73a5d76acac0">Script à intégrer</h2>

<p>sur le site de Google analytics, il faut inscrire son nom de domaine, puis copier le script indiqué dans un <em>template</em> :
<code>themes/lanyon-hugo/layouts/partials/google_analytics.html</code></p>

<pre><code class="language-javascript">&lt;script&gt;
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-XXXXXXX-1', 'auto');
  ga('send', 'pageview');

&lt;/script&gt;
</code></pre>

<h2 id="template:288ba409f9a55331bb5f73a5d76acac0">Template</h2>

<p>Il faut maintenant mettre une référence vers ce <em>template</em> dans le <em>template</em> de la page qui devra contenir le script google analytics :</p>

<p>dans le fichier <code>themes/lanyon-hugo/layouts/_default/single.html</code>, ajouter :</p>

<pre><code>{{ partial &quot;google_analytics.html&quot; . }}
</code></pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://alea.io/post/disqus/">Ajouter des commentaires via disqus</a></h1>
        <span class="post-date">Feb 17 2016</span>
        

<h2 id="script-de-configuration:bf318b8a60a617bf47277af43375fb12">Script de configuration</h2>

<p>Pour permettre le chargement de la zone de commentaires créée par <a href="https://disqus.com/">disqus</a>, il faut créer un <em>template</em> en créant le fichier : <code>themes/lanyon-hugo/layouts/partials/disqus.html</code>.</p>

<p>Ce fichier doit contenir le code suivant (code récupéré sur le site de hugo). Le code est spécifique pour permettre le chargement des commentaires, uniquement si le serveur ne tourne pas sur localhost.</p>

<pre><code class="language-javascript">&lt;div id=&quot;disqus_thread&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;

(function() {
    // Don't ever inject Disqus on localhost--it creates unwanted
    // discussions from 'localhost:1313' on your Disqus account...
    if (window.location.hostname == &quot;localhost&quot;)
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = '{{ .Site.DisqusShortname }}';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
&lt;/script&gt;
&lt;noscript&gt;Please enable JavaScript to view the &lt;a href=&quot;http://disqus.com/?ref_noscript&quot;&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;
&lt;a href=&quot;http://disqus.com/&quot; class=&quot;dsq-brlink&quot;&gt;comments powered by &lt;span class=&quot;logo-disqus&quot;&gt;Disqus&lt;/span&gt;&lt;/a&gt;
</code></pre>

<h2 id="template:bf318b8a60a617bf47277af43375fb12">Template</h2>

<p>Il faut maintenant mettre une référence vers ce <em>template</em> dans le <em>template</em> de la page qui devra contenir la zone disqus :</p>

<p>dans le fichier <code>themes/lanyon-hugo/layouts/_default/single.html</code>, ajouter :</p>

<pre><code>{{ partial &quot;disqus.html&quot; . }}
</code></pre>

<p>de telle sorte que le contenu soit :</p>

<pre><code class="language-html">{{ partial &quot;default_head.html&quot; . }}

&lt;div class=&quot;post&quot;&gt;
  &lt;h1 class=&quot;post-title&quot;&gt;{{ .Title }}&lt;/h1&gt;
  &lt;span class=&quot;post-date&quot;&gt;{{ .Date.Format .Site.Params.DateForm }}&lt;/span&gt;
  {{ .Content }}
&lt;/div&gt;

{{ partial &quot;disqus.html&quot; . }}
{{ partial &quot;default_foot.html&quot; . }}
</code></pre>

<h2 id="disqusshortname:bf318b8a60a617bf47277af43375fb12">disqusShortname</h2>

<p>Enfin, ajouter aux paramètres du site, dans le fichier <code>config.toml</code></p>

<pre><code>disqusShortname = &quot;le_nom_indique_par_disqus lors de l'inscription du disqus&quot;
</code></pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://alea.io/post/hugo_js/">hugo, highlight.js et d3.js</a></h1>
        <span class="post-date">Feb 14 2016</span>
        

<h2 id="highlight-js-à-partir-d-un-cdn-i-e-content-delivery-network:9f3719ccf3e885b3da2283a27c8547cb">Highlight.js (à partir d&rsquo;un cdn i.e. <em>content delivery network</em>)</h2>

<p>Pour pouvoir activer la coloration syntaxique pour le thème Lanyon, on peut inclure dans le <code>header</code> les chemins vers les scripts (entre les balises <code>&lt;head&gt;</code> et <code>&lt;/head&gt;</code>):</p>

<p>dans <code>&lt;dossier du site&gt;/themes/lanyon-hugo/partials/head.html</code>, insérer :</p>

<pre><code class="language-html">&lt;link rel=&quot;stylesheet&quot; href=&quot;//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/default.min.css&quot;&gt;

&lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js&quot;&gt;&lt;/script&gt;

&lt;script&gt;hljs.initHighlightingOnLoad();&lt;/script&gt;
</code></pre>

<p>On peut maintenant tester que cela fonctionne en entrant :</p>

<pre><code class="language-python">import numpy as np
import pandas

for i in range(10):
  print(i)
</code></pre>

<h2 id="d3-js-à-partir-d-un-cdn:9f3719ccf3e885b3da2283a27c8547cb">D3.js (à partir d&rsquo;un cdn)</h2>

<p>De la même façon, il faut indiquer dans <code>head.html</code> (le même fichier que dans la section précédente) :</p>

<pre><code class="language-html">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.14/d3.min.js&quot;&gt;&lt;/script&gt;
</code></pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="http://alea.io/post/hugo_github/">mise en place</a></h1>
        <span class="post-date">Feb 7 2016</span>
        

<h2 id="hugo:3b6eaebee660f5e91c409f85d4ddd0a9">Hugo</h2>

<p>Hugo est un programme de génération de site statique qui permet de transformer aisément des fichiers markdown en site web.</p>

<h2 id="configuration:3b6eaebee660f5e91c409f85d4ddd0a9">Configuration</h2>

<p>Pour connaître l&rsquo;architecture du système :</p>

<pre><code>$ uname -i
</code></pre>

<p>Récupérer <a href="https://github.com/spf13/hugo/releases">hugo</a> et suivre les instructions d&rsquo;installation (c&rsquo;est en fait un fichier binaire, il n&rsquo;y a pas de réelle installation).</p>

<p>On peut maintenant créer un squelette de site :</p>

<pre><code>$ hugo new site &lt;nom du site&gt;
</code></pre>

<p>crée un répertoire <nom du site> qui contient une structure prédéfinie destinée à être transformée par Hugo en site web.</p>

<pre><code>$ cd &lt;nom du site&gt;/post/
$ mkdir themes
</code></pre>

<p>le dossier themes contiendra l&rsquo;esthétique du site ainsi que les ressources statiques (javascript, image etc&hellip;) qu&rsquo;on voudra utiliser par la suite.</p>

<p>Maintenant que le dossier de themes est prêt, on peut y cloner un thème</p>

<pre><code>$ cd themes
$ git clone https://github.com/tummychow/lanyon-hugo.git
</code></pre>

<p>Le thème ne fonctionnera pas directement : il faut indiquer un paramètre dans le fichier de configuration config.toml à la racine du site :</p>

<pre><code>[Params]
	DateForm = &quot;Jan 2 2006&quot;
</code></pre>

<p>Tant qu&rsquo;on est dans le fichier de configuration, on <em>peut</em> (mais pas obligatoire) en profiter pour changer le titre du site et la <code>baseurl</code> qui contient le nom de domaine :</p>

<pre><code>baseurl = &quot;http://mon-superbe-site/&quot;
languageCode = &quot;fr-fr&quot;
title = &quot;notepad&quot;
</code></pre>

<p>On peut maintenant créer un nouveau post :</p>

<pre><code>$ cd &lt;nom du site&gt;
$ hugo new post/premier_post.md
</code></pre>

<p>Cette commande créera un fichier post.md dans le répertoire <code>&lt;nom du site&gt;/content/post/</code></p>

<p>Le fichier <code>post.md</code> comporte un entête particulier destiné à être interprété par <code>hugo</code>:</p>

<pre><code>+++
date = &quot;2016-02-07T15:02:19+01:00&quot;
draft = true
title = &quot;titre du post qui sera affiché dans le site&quot;
+++
</code></pre>

<p>Ajouter du contenu à la suite de l&rsquo;entête et lancer la commande :</p>

<pre><code>$ hugo server --theme=lanyon-hugo --buildDrafts
</code></pre>

<p>Si on est sous windows, pour la version de hugo disponible actuellement (le problème devrait disparaître pour la version v0.16), il faut plutôt lancer la commande :</p>

<pre><code>$ hugo server --theme=lanyon-hugo --buildDrafts --renderToDisk=true
</code></pre>

<p>Cette commande indique à hugo d&rsquo;utiliser le theme lanyon-hugo (qu&rsquo;on vient de cloner depuis github) et d&rsquo;afficher tout les posts, y compris les drafts. En effet, l&rsquo;entête contenait <code>draft=true</code> : par défaut, sans l&rsquo;option <code>--buildDrafts</code>, hugo n&rsquo;aurait pas traité notre <code>post.md</code> pour le transformer en site web.</p>

<p>à ce stade, nous avons une page acessible en prévisualisation dans le navigateur (un <em>vrai</em> navigateur, pas internet explorer) ; il suffit d&rsquo;indiquer l&rsquo;url : <code>localhost:1313</code> dans la barre d&rsquo;adresse.</p>

<h2 id="où-en-est-on:3b6eaebee660f5e91c409f85d4ddd0a9">Où en est-on ?</h2>

<p>Je peux créer un site en rédigeant mes posts en markdown, avec un thème minimaliste et je peux prévisualiser le résultat dans mon navigateur.</p>

    </div>
  
</div>

<div class="pagination">
  
  <span class="pagination-item older">Older</span>
  

  
  <span class="pagination-item newer">Newer</span>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

  </body>
</html>

